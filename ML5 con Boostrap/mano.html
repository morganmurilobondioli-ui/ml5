<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=|, initial-scale=1.0">
  <title>Document</title>

  <!--P5.js administrar componenetes Web = canvas, cámara, sonido, etc -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.10/p5.min.js"></script>
  <!--Librería ML5 - Machine Learning -->
  <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>
</head>
<body>
  <script>
    //Hace referencia a la red neuronal que ulitiza un modelo para detectar la mano
    let handPose;

    //Objeto para detectar input (vídeo) 
    let video;

    //Arrelo para guardar la ubicacion de las Manos
    let hands = [];

    function preload() {
      // Load the handPose model
      // Cargar el modelo de reconocimiento de manos
      handPose = ml5.handPose();
    }

    function setup() {
      //Lienzo = vista previa del video + puntos de la mano
      createCanvas(640, 480);
      // Create the webcam video and hide it
      video = createCapture(VIDEO);
      video.size(640, 480);
      video.hide();
      // start detecting hands from the webcam video
      // Inicio de la detección (recursividad)
      handPose.detectStart(video, gotHands);
    }

    // Draw = dibujar (renderiza puntos de ubicación de la mano en el CANVAS)
    function draw() {
      // Draw the webcam video
      //Dibujamos cada cuadro del video en el canvas
      image(video, 0, 0, width, height);

      // Draw all the tracked hand points
      //for superior = iterar sobre cada mano
      for (let i = 0; i < hands.length; i++) {
        let hand = hands[i];
        //for interior = iterar sobre cada dedo
        for (let j = 0; j < hand.keypoints.length; j++) {
          let keypoint = hand.keypoints[j];
          fill(0, 255, 0);
          noStroke();
          circle(keypoint.x, keypoint.y, 5);
        }
      }
    }

    // Callback function for when handPose outputs data
    // Detectar si existe una mano
    function gotHands(results) {
      // save the output to the hands variable
      hands = results;
    }
  </script>
</body>
</html>